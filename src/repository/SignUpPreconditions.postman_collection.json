{
	"info": {
		"_postman_id": "26ec86e9-ecbc-4cff-aa3a-6b648f710c11",
		"name": "SignUpPreconditions",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "SignUp",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "74427198-df9a-46ad-9e4e-5a51c0e2f3a3",
						"exec": [
							"//\"use strict\";",
							"",
							"var text = \"\";",
							"var possible = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\";",
							"",
							"function makeRandomEmail() {",
							"    for (let i = 0; i < 9; i++)",
							"        text += possible.charAt(Math.floor(Math.random() * possible.length));",
							"    return text + \"@guerrillamailblock.com\";",
							"}",
							"",
							"pm.test(\"SetEnvironmentVariables\", function (err, res)",
							"{",
							"    const staging_url = \"staging-acl.dx.exchange\",",
							"          integration_url = \"integration-acl.dx.exchange\",",
							"          base_url = \"acl.dx.exchange\",",
							"          wtp_staging_url = \"https://staging-plat.dx.exchange\",",
							"          wtp_integration_url = \"http://integration-plat.dx.exchange:30010\",",
							"          wtp_base_url = \"https://plat.dx.exchange\",",
							"          dx = pm.environment.get(\"DX\"),",
							"          protocol = \"https://\"; // \"http://\"\"",
							"    if(dx === \"DX\")",
							"    {",
							"        postman.setEnvironmentVariable(\"email\", makeRandomEmail());   ",
							"        postman.setEnvironmentVariable(\"protocol\", protocol);",
							"        postman.setEnvironmentVariable(\"DxBaseUrl\", staging_url);",
							"        postman.setEnvironmentVariable(\"wtp_base_url\", wtp_staging_url);",
							"        postman.setEnvironmentVariable(\"captcha\", \"test_test\");",
							"        postman.setEnvironmentVariable(\"language\", \"en\");",
							"        postman.setEnvironmentVariable(\"password\", \"1Aa@<>12\");",
							"        postman.setEnvironmentVariable(\"first_name\", \"QATest\");",
							"        postman.setEnvironmentVariable(\"last_name\", \"TestQa\");",
							"        postman.setEnvironmentVariable(\"verification_url\", \"{{wtp_base_url}}/appProxy/openAccountDx.html\");",
							"    }",
							"    else",
							"    {",
							"        return console.log(\"Failed to set environment variables.\");",
							"    }  ",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "test",
					"script": {
						"id": "f301bb26-62a2-439a-9147-4f9aae655172",
						"exec": [
							"pm.test(\"Status code is 200\", function () ",
							"{",
							"    var auth_token = \"\",",
							"        customer_id,",
							"        reason = \"\",",
							"        statusCode = \"Internal Server Error\";",
							"    if((pm.response.reason(responseBody)) !== statusCode)",
							"    {",
							"        var jsonData = pm.response.json();",
							"        auth_token = jsonData.result.authToken;",
							"        customer_id = jsonData.result.customerId;",
							"        if(auth_token.length !== 0)",
							"        {",
							"            pm.environment.set(\"auth_token\", auth_token);",
							"            pm.environment.set(\"customer_id\", customer_id);",
							"            console.log(customer_id);",
							"        }",
							"        else",
							"        {",
							"            console.log(jsonData.result.errors.Email);",
							"        }",
							"    }",
							"    else",
							"    {",
							"        reason = pm.response.reason(responseBody);",
							"        console.log(reason);",
							"        return pm.response.to.have.status(200);",
							"    } ",
							"});",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					},
					{
						"key": "Test-Token",
						"value": "{{test_token}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\r\n  \"jsonrpc\": \"{{version}}\",\r\n  \"method\": \"Authorization.SignUp\",\r\n  \"params\": [{\r\n    \"FirstName\": \"{{first_name}}\",\r\n    \"LastName\": \"{{last_name}}\",\r\n    \"Email\": \"{{email}}\",\r\n    \"Password\": \"{{password}}\",\r\n    \"receivePromoEmail\": false,\r\n    \"AcceptTerms\": true,\r\n    \"Captcha\": \"{{captcha}}\",\r\n    \"siteLanguage\": \"{{language}}\",\r\n    \"EmailValidationUrl\": \"{{verification_url}}\",\r\n    \"ReferLink\": \"{{verification_url}}\",\r\n    \"CampaignId\": 1,\r\n    \"SubCampaignId\": 1,\r\n    \"AAid\": \"aaid\",\r\n    \"ABid\": \"abid\",\r\n    \"ACid\": \"acid\",\r\n    \"receivePromoSMS\": false,\r\n    \"receivePromoPushToMobile\": false,\r\n    \"ReceivePromoEmail\" : false,\r\n    \"receiveTradingEmail\": false \r\n  }]\r\n}\r\n"
				},
				"url": {
					"raw": "{{protocol}}{{DxBaseUrl}}",
					"host": [
						"{{protocol}}{{DxBaseUrl}}"
					]
				}
			},
			"response": [
				{
					"name": "SignUp_response3",
					"originalRequest": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"jsonrpc\": \"2.0\",\r\n  \"method\": \"Authorization.SignUp\",\r\n  \"params\": [{\r\n    \"FirstName\": \"{{first_name}}\",\r\n    \"LastName\": \"{{last_name}}\",\r\n    \"Email\": \"{{email}}\",\r\n    \"Password\": \"{{password}}\",\r\n    \"receivePromoEmail\": false,\r\n    \"AcceptTerms\": true,\r\n    \"Captcha\": \"{{captcha}}\",\r\n    \"siteLanguage\": \"{{language}}\",\r\n    \"EmailValidationUrl\": \"{{verification_url}}\",\r\n    \"receivePromoSMS\": false,\r\n    \"receivePromoPushToMobile\": false,\r\n    \"receiveTradingEmail\": false \r\n  }],\r\n  \"id\": \"{{id}}\"\r\n}\r\n"
						},
						"url": {
							"raw": "https://{{DxBaseUrl}}",
							"protocol": "https",
							"host": [
								"{{DxBaseUrl}}"
							]
						}
					},
					"status": "OK",
					"code": 200,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Accept",
							"value": "application/json, text/javascript, */*; q=0.01",
							"name": "Accept",
							"description": "Custom header"
						},
						{
							"key": "Accept-Encoding",
							"value": "gzip, deflate, br",
							"name": "Accept-Encoding",
							"description": "Custom header"
						},
						{
							"key": "Accept-Language",
							"value": "en-US,en;q=0.9,ru;q=0.8",
							"name": "Accept-Language",
							"description": "Custom header"
						},
						{
							"key": "Access-Control-Allow-Headers",
							"value": "DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range,Authorization",
							"name": "Access-Control-Allow-Headers",
							"description": "Used in response to a preflight request to indicate which HTTP headers can be used when making the actual request."
						},
						{
							"key": "Access-Control-Allow-Methods",
							"value": "GET, POST, OPTIONS",
							"name": "Access-Control-Allow-Methods",
							"description": "Specifies the method or methods allowed when accessing the resource. This is used in response to a preflight request."
						},
						{
							"key": "Access-Control-Allow-Origin",
							"value": "*",
							"name": "Access-Control-Allow-Origin",
							"description": "Specifies a URI that may access the resource. For requests without credentials, the server may specify '*' as a wildcard, thereby allowing any origin to access the resource."
						},
						{
							"key": "Authorization",
							"value": "eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6Imxvbmdfd2F5XzI0QG1haWxpbmF0b3IuY29tIiwiZmlyc3ROYW1lIjoibG9uZyIsImxhc3ROYW1lIjoid2F5IiwiY3VzdG9tZXJJZCI6IjEwMDAwMTEwMDAwMDAwMDA2MiIsImV4cCI6MTUzMzA0NzQ2MCwianRpIjoiMTAwMDAxMTAwMDAwMDAwMDYyIn0.v5BI8PmH42pzfa_clvuv7vtfrSbV4MZAv-2dwpoRDy77liNn5sB9rkxYyLdtmyL-kIYWIMRBrh5W_Zi6JjAG-A",
							"name": "Authorization",
							"description": "Custom header"
						},
						{
							"key": "Content-Encoding",
							"value": "gzip",
							"name": "Content-Encoding",
							"description": "The type of encoding used on the data."
						},
						{
							"key": "Content-Type",
							"value": "application/json",
							"name": "Content-Type",
							"description": "The mime type of this content"
						},
						{
							"key": "Date",
							"value": "Mon, 02 Jul 2018 08:14:03 GMT",
							"name": "Date",
							"description": "The date and time that the message was sent"
						},
						{
							"key": "Incap-Client-Ip",
							"value": "93.157.86.33",
							"name": "Incap-Client-Ip",
							"description": "Custom header"
						},
						{
							"key": "Incap-Proxy-1052",
							"value": "OK",
							"name": "Incap-Proxy-1052",
							"description": "Custom header"
						},
						{
							"key": "Origin",
							"value": "https://plat.dx.exchange",
							"name": "Origin",
							"description": "Custom header"
						},
						{
							"key": "Referer",
							"value": "https://plat.dx.exchange/appProxy/openAccountDx.html",
							"name": "Referer",
							"description": "Custom header"
						},
						{
							"key": "Request-Id",
							"value": "1fb909e4-833f-481b-96e5-d58b0acbaca3",
							"name": "Request-Id",
							"description": "Custom header"
						},
						{
							"key": "Request-Ip",
							"value": "93.157.86.33",
							"name": "Request-Ip",
							"description": "Custom header"
						},
						{
							"key": "Server",
							"value": "fasthttp",
							"name": "Server",
							"description": "A name for the server"
						},
						{
							"key": "Source-System-Id",
							"value": "1",
							"name": "Source-System-Id",
							"description": "Custom header"
						},
						{
							"key": "Transfer-Encoding",
							"value": "chunked",
							"name": "Transfer-Encoding",
							"description": "The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity."
						},
						{
							"key": "User-Agent",
							"value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36",
							"name": "User-Agent",
							"description": "Custom header"
						},
						{
							"key": "X-CDN",
							"value": "Incapsula",
							"name": "X-CDN",
							"description": "Custom header"
						},
						{
							"key": "X-Forwarded-For",
							"value": "93.157.86.33",
							"name": "X-Forwarded-For",
							"description": "A de facto standard for identifying the originating IP address of a client connecting to a web server through an HTTP proxy or load balancer"
						},
						{
							"key": "X-Iinfo",
							"value": "2-9676495-9679353 NNNN CT(0 0 0) RT(1530519138697 101752) q(0 0 0 -1) r(25 25) U6",
							"name": "X-Iinfo",
							"description": "Custom header"
						}
					],
					"cookie": [
						{
							"expires": "Invalid Date",
							"httpOnly": false,
							"domain": "dx.exchange",
							"path": "/",
							"secure": false,
							"value": "YHyZ3AdQTX6xER0+31bfsN+sM1sAAAAAQUIPAAAAAACoELAIThVZ86Yfyi99EjPO",
							"key": "visid_incap_1714807"
						},
						{
							"expires": "Invalid Date",
							"httpOnly": false,
							"domain": "dx.exchange",
							"path": "/",
							"secure": false,
							"value": "7hIiMtPijTSz6Aq9hnSZDlfDNFsAAAAAzIFlM7pBN9+9VpjbH2BvuQ==",
							"key": "incap_ses_1052_1714807"
						},
						{
							"expires": "Invalid Date",
							"httpOnly": false,
							"domain": "dx.exchange",
							"path": "/",
							"secure": false,
							"value": "s803lYmlSGSgT++COvd9b/bDNFsAAAAAQUIPAAAAAAB8pXTWcYSO5eCD2aYD2ibF",
							"key": "visid_incap_1721148"
						},
						{
							"expires": "Invalid Date",
							"httpOnly": false,
							"domain": "dx.exchange",
							"path": "/",
							"secure": false,
							"value": "8qDwX0wUSlmCooi/hnSZDmLeOVsAAAAADfrXUfOM+MsA+he2Bp/utA==",
							"key": "incap_ses_1052_1721148"
						}
					],
					"body": "{\"id\":\"1\",\"result\":{\"customerId\":\"100001100000000091\",\"authToken\":\"eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6ImtSSXZFb25yQG1haWxpbmF0b3IuY29tIiwiZmlyc3ROYW1lIjoiUUFfdGVzdCIsImxhc3ROYW1lIjoiVGVzdF9xYSIsImN1c3RvbWVySWQiOiIxMDAwMDExMDAwMDAwMDAwOTEiLCJleHAiOjE1MzMxMTEyNDMsImp0aSI6IjEwMDAwMTEwMDAwMDAwMDA5MSJ9.ckpO8kZ7UW7HClWzG9qIuPxN6xEENYXDoogxcmzH4LkQOMm3gmy_BIIpFxLGwG-xx0GRX1dm-PZzIG7RKPcfAw\",\"errors\":null,\"expiry\":2592000},\"error\":null}\n"
				},
				{
					"name": "SignUp-Response4",
					"originalRequest": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"jsonrpc\": \"2.0\",\r\n  \"method\": \"Authorization.SignUp\",\r\n  \"params\": [{\r\n    \"FirstName\": \"{{first_name}}\",\r\n    \"LastName\": \"{{last_name}}\",\r\n    \"Email\": \"{{email}}\",\r\n    \"Password\": \"{{password}}\",\r\n    \"receivePromoEmail\": false,\r\n    \"AcceptTerms\": true,\r\n    \"Captcha\": \"{{captcha}}\",\r\n    \"siteLanguage\": \"{{language}}\",\r\n    \"EmailValidationUrl\": \"{{verification_url}}\",\r\n    \"ReferLink\": \"{{verification_url}}\",\r\n    \"CampaignId\": 1,\r\n    \"SubCampaignId\": 1,\r\n    \"AAid\": \"aaid\",\r\n    \"ABid\": \"abid\",\r\n    \"ACid\": \"acid\",\r\n    \"receivePromoSMS\": false,\r\n    \"receivePromoPushToMobile\": false,\r\n    \"ReceivePromoEmail\" : false,\r\n    \"receiveTradingEmail\": false \r\n  }],\r\n  \"id\": \"{{id}}\"\r\n}\r\n"
						},
						"url": {
							"raw": "https://{{DxBaseUrl}}",
							"protocol": "https",
							"host": [
								"{{DxBaseUrl}}"
							]
						}
					},
					"status": "OK",
					"code": 200,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Accept",
							"value": "application/json, text/javascript, */*; q=0.01",
							"name": "Accept",
							"description": "Custom header"
						},
						{
							"key": "Accept-Encoding",
							"value": "gzip, deflate, br",
							"name": "Accept-Encoding",
							"description": "Custom header"
						},
						{
							"key": "Accept-Language",
							"value": "ja-JP,ja;q=0.8,en-US;q=0.6,en;q=0.4",
							"name": "Accept-Language",
							"description": "Custom header"
						},
						{
							"key": "Access-Control-Allow-Headers",
							"value": "DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range,Authorization",
							"name": "Access-Control-Allow-Headers",
							"description": "Used in response to a preflight request to indicate which HTTP headers can be used when making the actual request."
						},
						{
							"key": "Access-Control-Allow-Methods",
							"value": "GET, POST, OPTIONS",
							"name": "Access-Control-Allow-Methods",
							"description": "Specifies the method or methods allowed when accessing the resource. This is used in response to a preflight request."
						},
						{
							"key": "Access-Control-Allow-Origin",
							"value": "*",
							"name": "Access-Control-Allow-Origin",
							"description": "Specifies a URI that may access the resource. For requests without credentials, the server may specify '*' as a wildcard, thereby allowing any origin to access the resource."
						},
						{
							"key": "Connection",
							"value": "close",
							"name": "Connection",
							"description": "Options that are desired for the connection"
						},
						{
							"key": "Content-Encoding",
							"value": "gzip",
							"name": "Content-Encoding",
							"description": "The type of encoding used on the data."
						},
						{
							"key": "Content-Type",
							"value": "application/json",
							"name": "Content-Type",
							"description": "The mime type of this content"
						},
						{
							"key": "Date",
							"value": "Mon, 02 Jul 2018 10:16:54 GMT",
							"name": "Date",
							"description": "The date and time that the message was sent"
						},
						{
							"key": "Incap-Client-Ip",
							"value": "49.98.151.57",
							"name": "Incap-Client-Ip",
							"description": "Custom header"
						},
						{
							"key": "Incap-Proxy-894",
							"value": "OK",
							"name": "Incap-Proxy-894",
							"description": "Custom header"
						},
						{
							"key": "Origin",
							"value": "https://dx.exchange",
							"name": "Origin",
							"description": "Custom header"
						},
						{
							"key": "Referer",
							"value": "https://dx.exchange/",
							"name": "Referer",
							"description": "Custom header"
						},
						{
							"key": "Request-Id",
							"value": "7b009c8c-0399-4f87-b331-ade81e486c06",
							"name": "Request-Id",
							"description": "Custom header"
						},
						{
							"key": "Request-Ip",
							"value": "49.98.151.57",
							"name": "Request-Ip",
							"description": "Custom header"
						},
						{
							"key": "Server",
							"value": "fasthttp",
							"name": "Server",
							"description": "A name for the server"
						},
						{
							"key": "Source-System-Id",
							"value": "1",
							"name": "Source-System-Id",
							"description": "Custom header"
						},
						{
							"key": "Transfer-Encoding",
							"value": "chunked",
							"name": "Transfer-Encoding",
							"description": "The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity."
						},
						{
							"key": "User-Agent",
							"value": "Mozilla/5.0 (Linux; Android 7.0; SO-01J Build/39.2.B.0.336) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.116 Mobile Safari/537.36",
							"name": "User-Agent",
							"description": "Custom header"
						},
						{
							"key": "X-CDN",
							"value": "Incapsula",
							"name": "X-CDN",
							"description": "Custom header"
						},
						{
							"key": "X-Forwarded-For",
							"value": "49.98.151.57",
							"name": "X-Forwarded-For",
							"description": "A de facto standard for identifying the originating IP address of a client connecting to a web server through an HTTP proxy or load balancer"
						},
						{
							"key": "X-Iinfo",
							"value": "4-21901013-21901018 NNNN CT(0 0 0) RT(1530526610980 17) q(0 0 0 -1) r(26 26) U6",
							"name": "X-Iinfo",
							"description": "Custom header"
						}
					],
					"cookie": [
						{
							"expires": "Invalid Date",
							"httpOnly": false,
							"domain": "dx.exchange",
							"path": "/",
							"secure": false,
							"value": "YHyZ3AdQTX6xER0+31bfsN+sM1sAAAAAQUIPAAAAAACoELAIThVZ86Yfyi99EjPO",
							"key": "visid_incap_1714807"
						},
						{
							"expires": "Invalid Date",
							"httpOnly": false,
							"domain": "dx.exchange",
							"path": "/",
							"secure": false,
							"value": "7hIiMtPijTSz6Aq9hnSZDlfDNFsAAAAAzIFlM7pBN9+9VpjbH2BvuQ==",
							"key": "incap_ses_1052_1714807"
						},
						{
							"expires": "Invalid Date",
							"httpOnly": false,
							"domain": "dx.exchange",
							"path": "/",
							"secure": false,
							"value": "s803lYmlSGSgT++COvd9b/bDNFsAAAAAQUIPAAAAAAB8pXTWcYSO5eCD2aYD2ibF",
							"key": "visid_incap_1721148"
						},
						{
							"expires": "Invalid Date",
							"httpOnly": false,
							"domain": "dx.exchange",
							"path": "/",
							"secure": false,
							"value": "kUTnC8OJxmreh5i/hnSZDpH6OVsAAAAAbNmtm9GX+H75qyiql5LZIg==",
							"key": "incap_ses_1052_1721148"
						}
					],
					"body": "{\"id\":\"1\",\"result\":{\"customerId\":\"100001100000000105\",\"authToken\":\"eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6IkFYWExBTVpUQG1haWxpbmF0b3IuY29tIiwiZmlyc3ROYW1lIjoiUUFfdGVzdCIsImxhc3ROYW1lIjoiVGVzdF9xYSIsImN1c3RvbWVySWQiOiIxMDAwMDExMDAwMDAwMDAxMDUiLCJleHAiOjE1MzMxMTg2MTQsImp0aSI6IjEwMDAwMTEwMDAwMDAwMDEwNSJ9.tUdHMiEYQYXVMwhCtALa0tda0WrX9gWWtNbC2flfmZPuhX46bOkNzcgplMdDBoGNHintKtqxehtG5Vs_WJ60NQ\",\"errors\":null,\"expiry\":2592000},\"error\":null}\n"
				}
			]
		},
		{
			"name": "ServerResponse",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "8537793e-e397-428b-b457-0dae90af1a4f",
						"exec": [
							"pm.test(\"Status code is 200\", function () ",
							"{",
							"    var customer_id = \"\",",
							"    reason = \"\",",
							"    statusCode = \"Internal Server Error\";",
							"    if((pm.response.reason(responseBody)) !== statusCode)",
							"    {",
							"        customer_id = pm.variables.get(\"customer_id\");",
							"        pm.test(\"Body matches string\", function () ",
							"        {",
							"            if(pm.expect(pm.response.text()).to.include(\"Saved to\"))",
							"            {",
							"                console.log(customer_id + \" - Successfully saved.\");",
							"            }else return console.log(\"Problem with Express server.\");",
							"        });",
							"    }",
							"    else",
							"    {",
							"        reason = pm.response.reason(responseBody);",
							"        console.log(reason);",
							"        return pm.response.to.have.status(200);",
							"    } ",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"name": "Content-Type",
						"value": "application/x-www-form-urlencoded",
						"type": "text"
					}
				],
				"body": {
					"mode": "urlencoded",
					"urlencoded": [
						{
							"key": "payload",
							"value": "{{customer_id}}",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "http://localhost:3000/response",
					"protocol": "http",
					"host": [
						"localhost"
					],
					"port": "3000",
					"path": [
						"response"
					]
				}
			},
			"response": []
		}
	]
}